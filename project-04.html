<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Project 4: Kernel - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{background:#fff;color:#333;display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{background-color:#eaffea;color:#55a532}.hljs-deletion{background-color:#ffecec;color:#bd2c00}.hljs-link{text-decoration:underline}.markdown-body{word-wrap:break-word;font-size:16px;line-height:1.5}.markdown-body:after,.markdown-body:before{content:"";display:table}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-bottom:16px;margin-top:0}.markdown-body hr{background-color:#e7e7e7;border:0;height:.25em;margin:24px 0;padding:0}.markdown-body blockquote{border-left:.25em solid #ddd;color:#777;font-size:16px;padding:0 1em}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb;color:#555;display:inline-block;font-size:11px;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{border-bottom:1px solid #eee;padding-bottom:.3em}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{color:#777;font-size:.85em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{list-style-type:none;padding:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0;margin-top:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:1em;font-style:italic;font-weight:700;margin-top:16px;padding:0}.markdown-body dl dd{margin-bottom:16px;padding:0 16px}.markdown-body table{display:block;overflow:auto;width:100%;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{border:1px solid #ddd;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{background-color:#fff;box-sizing:initial;max-width:100%}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{background-color:initial;max-width:none;vertical-align:text-top}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #ddd;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#0000000a;border-radius:3px;font-size:85%;margin:0;padding:.2em 0}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{content:"\00a0";letter-spacing:-.2em}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{background:#0000;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{border-radius:3px;font-size:85%;line-height:1.45;overflow:auto}.markdown-body:not(.next-editor) pre{background-color:#f7f7f7;padding:16px}.markdown-body pre code,.markdown-body pre tt{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{font-size:12px;line-height:1;overflow:hidden;padding:5px;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{background:#fff;border:0;padding:10px 8px 9px;text-align:right}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{background:#f8f8f8;border-top:0;font-weight:700}.news .alert .markdown-body blockquote{border:0;padding:0 0 0 40px}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{cursor:default!important;float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle}.markdown-body{max-width:758px;overflow:visible!important;padding-bottom:40px;padding-top:40px;position:relative}.markdown-body.next-editor{overflow-x:hidden!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{border-right:3px solid #6ce26c!important;box-sizing:initial;color:#afafaf!important;cursor:default;display:inline-block;min-width:20px;padding:0 8px 0 0;position:relative;text-align:right;z-index:4}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-bottom:none;border-left:none;border-top:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-collapse:inherit!important;border-spacing:0}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{margin-bottom:unset;overflow:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert{display:flex;flex-direction:column;gap:16px}.markdown-body .alert>*{margin:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{background-color:inherit;border-radius:0;overflow:visible;text-align:center;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{height:100%;max-width:100%}.markdown-body pre>code.wrap{word-wrap:break-word;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{background-color:#000;background-position:50%;background-repeat:no-repeat;background-size:contain;cursor:pointer;display:table;overflow:hidden;text-align:center}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{object-fit:contain;width:100%;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{height:100%;left:0;position:absolute;top:0;width:100%}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{color:#fff;height:auto;left:50%;opacity:.3;position:absolute;top:50%;transform:translate(-50%,-50%);transition:opacity .2s;width:auto;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.figma{display:table;padding-bottom:56.25%;position:relative;width:100%}.figma iframe{border:1px solid #eee;bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.markmap-container{height:300px}.markmap-container>svg{height:100%;width:100%}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{color:#777;margin:25px auto -25px;max-width:760px;position:relative;z-index:2}.toc .invisable-node{list-style-type:none}.ui-toc{bottom:20px;position:fixed;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{border-bottom-left-radius:0;border-top-left-radius:0;height:40px;padding:10px 4px}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{color:#fff;opacity:1;transition:opacity .2s}.ui-toc-label:focus{background-color:#ccc;color:#000;opacity:.3}.ui-toc-label:hover{background-color:#ccc;opacity:1;transition:opacity .2s}.ui-toc-dropdown{margin-bottom:20px;margin-top:20px;max-height:70vh;max-width:45vw;overflow:auto;padding-left:10px;padding-right:10px;text-align:inherit;width:25vw}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{letter-spacing:.0029em;padding-right:0}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{color:#767676;display:block;font-size:13px;font-weight:500;padding:4px 20px}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{background-color:initial;border-left:1px solid #000;color:#000;padding-left:19px;text-decoration:none}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{border-left:none;border-right:1px solid #000;padding-right:19px}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{background-color:initial;border-left:2px solid #000;color:#000;font-weight:700;padding-left:18px}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{border-left:none;border-right:2px solid #000;padding-right:18px}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:30px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:40px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{font-weight:500;padding-left:28px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{font-weight:500;padding-left:38px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{max-height:70vh;max-width:15vw;overflow:auto;position:fixed;top:0}.back-to-top,.expand-toggle,.go-to-bottom{color:#999;display:block;font-size:12px;font-weight:500;margin-left:10px;margin-top:10px;padding:4px 10px}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{background-position:50%;background-repeat:no-repeat;background-size:cover;border-radius:50%;display:block;height:20px;margin-bottom:2px;margin-right:5px;margin-top:2px;width:20px}.ui-user-icon.small{display:inline-block;height:18px;margin:0 0 .2em;vertical-align:middle;width:18px}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;padding-left:22px;text-decoration:none}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}.inline-spoiler-section{cursor:pointer}.inline-spoiler-section .spoiler-text{background-color:#333;border-radius:2px}.inline-spoiler-section .spoiler-text>*{opacity:0}.inline-spoiler-section .spoiler-img{filter:blur(10px)}.inline-spoiler-section.raw{background-color:#333;border-radius:2px}.inline-spoiler-section.raw>*{opacity:0}.inline-spoiler-section.unveil{cursor:auto}.inline-spoiler-section.unveil .spoiler-text{background-color:#3333331a}.inline-spoiler-section.unveil .spoiler-text>*{opacity:1}.inline-spoiler-section.unveil .spoiler-img{filter:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{color:#222;position:relative;z-index:1}.markdown-body.slides:before{background-color:currentColor;bottom:0;box-shadow:0 0 0 50vw;content:"";display:block;left:0;position:absolute;right:0;top:0;z-index:-1}.markdown-body.slides section[data-markdown]{background-color:#fff;margin-bottom:1.5em;position:relative;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{left:1em;max-height:100%;overflow:hidden;position:absolute;right:1em;top:50%;transform:translateY(-50%)}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{border:3px solid #777;content:"";height:1.5em;position:absolute;right:1em;top:-1.5em}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}svg{text-shadow:none}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style=""><h1 id="Project-4-Kernel" data-id="Project-4-Kernel" style=""><a class="anchor hidden-xs" href="#Project-4-Kernel" title="Project-4-Kernel"><span class="octicon octicon-link"></span></a><span>Project 4: Kernel</span></h1><p><span>In this project, you will be provided with a basic CPU emulator. You will extend the CPU emulator with support for instructions that can be used implement a kernel, you will implement a (very simple) kernel using these instructions, and you will attempt to find and exploit vulnerabilities in your classmates' kernels.</span></p><h2 id="Architecture" data-id="Architecture" style=""><a class="anchor hidden-xs" href="#Architecture" title="Architecture"><span class="octicon octicon-link"></span></a><span>Architecture</span></h2><p><span>This section describes the CPU architecture and the instructions which are already implemented.</span></p><h3 id="Words" data-id="Words" style=""><a class="anchor hidden-xs" href="#Words" title="Words"><span class="octicon octicon-link"></span></a><span>Words</span></h3><p><span>The CPU is a 32-bit, word-oriented CPU. This means that, unlike computers which you've worked with before, each memory address uniquely addresses a single 32-bit word rather than a single byte. If this analogy helps, you can think of this CPU as having 32-bit bytes.</span></p><h3 id="Memory" data-id="Memory" style=""><a class="anchor hidden-xs" href="#Memory" title="Memory"><span class="octicon octicon-link"></span></a><span>Memory</span></h3><p><span>The memory available to the CPU is a sequence of words which are addressed starting at 0. Memory can be accessed using the </span><code>load</code><span> and </span><code>store</code><span> instructions, which are described below.</span></p><h3 id="Registers" data-id="Registers" style=""><a class="anchor hidden-xs" href="#Registers" title="Registers"><span class="octicon octicon-link"></span></a><span>Registers</span></h3><p><span>The CPU has 8 registers which are numbered 0 through 7. Register 7 is also the instruction pointer. Each register stores a single word.</span></p><p><span>In text, we denote these registers as </span><code>r0</code><span> through </span><code>r7</code><span>.</span></p><h3 id="IO" data-id="IO" style=""><a class="anchor hidden-xs" href="#IO" title="IO"><span class="octicon octicon-link"></span></a><span>I/O</span></h3><p><span>The CPU is attached to one input device and one output device. Each device is byte-oriented (this makes it easier to interact with the terminal). The instructions </span><code>read</code><span> and </span><code>write</code><span> read and write a single byte directly from/to the input/output devices.</span></p><p><span>Since the CPU is word-oriented, we need to convert between 32-bit words and 8-bit bytes in order to interact with the I/O devices. We do this by only considering the least-significant 8 bits of a word and discarding the rest. For example, consider the following instructions:</span></p><pre><code class="text hljs">read r3
write r5
</code></pre><p><em><span>This is the format that you will write your kernel and any other programs in. We provide a basic "assembler" which can read this format and compile it into the equivalent sequence of instruction words. The assembler format is documented below.</span></em></p><p><code>read r3</code><span> reads one byte from the input device. It overwrites the contents of </span><code>r3</code><span> with a 32-bit word whose lowest-order 8 bits are set to the value of the input, and whose remaining (higher-order) bits are set to zeros.</span></p><p><span>Similarly, </span><code>write r5</code><span> writes one byte to the output device. The byte that it writes is taken from the lowest-order 8 bits of </span><code>r5</code><span>.</span></p><h3 id="Halting" data-id="Halting" style=""><a class="anchor hidden-xs" href="#Halting" title="Halting"><span class="octicon octicon-link"></span></a><span>Halting</span></h3><p><span>It is possible for the CPU to halt. This can happen either due to an explicit invocation of the </span><code>halt</code><span> instruction or because an instruction was executed which gets the CPU into an illegal state. Examples of such instructions are invalid instructions (e.g., instructions with an invalid instruction code), instructions which attempt to read from a memory address which is out-of-bounds of the CPU's memory, instructions which refer to a register which doesn't exist (e.g., </span><code>r8</code><span>), etc.</span></p><h3 id="Execution" data-id="Execution" style=""><a class="anchor hidden-xs" href="#Execution" title="Execution"><span class="octicon octicon-link"></span></a><span>Execution</span></h3><p><span>In each instruction cycle, the CPU executes the following steps in this order:</span></p><ul>
<li><span>Executes the "kernel pre-execute hook" (more on this later), which may cause the CPU to halt</span></li>
<li><span>Reads the value of </span><code>r7</code><span> (let's refer to this value as </span><code>iptr</code><span>)</span></li>
<li><span>Loads the word at address </span><code>iptr</code><span> in memory, or halts if the address is out-of-bounds</span></li>
<li><span>Decodes this word as an instruction, or halts if decoding fails</span></li>
<li><span>Increments </span><code>r7</code></li>
<li><span>Executes the instruction, halting if execution fails or if the instruction was an explicit </span><code>halt</code><span> instruction</span></li>
</ul><h3 id="Instruction-encoding" data-id="Instruction-encoding" style=""><a class="anchor hidden-xs" href="#Instruction-encoding" title="Instruction-encoding"><span class="octicon octicon-link"></span></a><span>Instruction encoding</span></h3><p><span>Each instruction is encoded as a single word, consisting of one code byte followed by three argument bytes:</span></p><pre><code class="text hljs">MSB                          LSB
v                              v
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
|------||------||------||------|
  code     a0      a1      a2
</code></pre><p><span>This diagram reads from most-significant bit (MSB) on the left to least-significant bit (LSB) on the right.</span></p><p><span>The </span><code>code</code><span> identifies which instruction is encoded. The meaning of the arguments </span><code>a0</code><span>, </span><code>a1</code><span>, and </span><code>a2</code><span> differ by instruction. Also, not all instructions make use of all arguments - for example, the </span><code>halt</code><span> instruction takes no arguments, and so when the </span><code>halt</code><span> instruction is executed, </span><code>a0</code><span>, </span><code>a1</code><span>, and </span><code>a2</code><span> are ignored.</span></p><p><span>Despite arguments being interpreted differently by different instructions, there are some common patterns.</span></p><p><span>First, arguments often contain the addresses of registers. For example, consider the following instruction:</span></p><pre><code class="text hljs">add r0 r1 r2
</code></pre><p><span>This instruction adds the value in </span><code>r0</code><span> to the value in </span><code>r1</code><span> and stores the result in </span><code>r2</code><span>.</span></p><p><span>Second, arguments may also contain literal values (i.e., values which are hard-coded into the instruction itself). This raises a question: How do we differentiate whether an argument contains a register address or a literal value? In most cases (the only exception is the </span><code>loadLiteral</code><span> instruction - see below for more details), the most-significant bit of the argument is used to distinguish between register addresses and literal values. For example, consider the following argument values:</span></p><pre><code class="text hljs">MSB  LSB
v      v
00000111
10000111
</code></pre><p><span>The first argument - whose MSB is 0 - encodes the address of </span><code>r7</code><span>. The second argument - whose MSB is 1 - encodes the literal value 7.</span></p><p><span>Usually, you will not have to think too hard about how arguments are encoded. The assembler (described below) will take care of interpreting a value like </span><code>r7</code><span> as </span><code>00000111</code><span> and a value like </span><code>7</code><span> as </span><code>10000111</code><span>. However, knowing about this encoding may be useful for debugging.</span></p><h3 id="Instruction-reference" data-id="Instruction-reference" style=""><a class="anchor hidden-xs" href="#Instruction-reference" title="Instruction-reference"><span class="octicon octicon-link"></span></a><span>Instruction reference</span></h3><p><span>This section lists the instructions which are provided by default. Part of your assignment will be to add new instructions to this list.</span></p><h4 id="Arithmetic-instructions" data-id="Arithmetic-instructions"><a class="anchor hidden-xs" href="#Arithmetic-instructions" title="Arithmetic-instructions"><span class="octicon octicon-link"></span></a><span>Arithmetic instructions</span></h4><p><span>Most arithmetic instructions are of the form:</span></p><pre><code class="text hljs">&lt;instr&gt; &lt;a0&gt; &lt;a1&gt; &lt;a2&gt;
</code></pre><p><span>Each arithmetic instruction treats </span><code>&lt;a0&gt;</code><span> and </span><code>&lt;a1&gt;</code><span> as either register addresses or literal values. It loads the register or literal values, computes the instruction's arithmetic operation, and stores the result in the register addressed by </span><code>&lt;a2&gt;</code><span>.</span></p><table>
<thead>
<tr>
<th><span>Instruction</span></th>
<th><span>Operation (using Go syntax)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>add</code></td>
<td><code>&lt;a0&gt; + &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>sub</code></td>
<td><code>&lt;a0&gt; - &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>mul</code></td>
<td><code>&lt;a0&gt; * &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>div</code></td>
<td><code>&lt;a0&gt; / &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>shl</code></td>
<td><code>&lt;a0&gt; &lt;&lt; &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>shr</code></td>
<td><code>&lt;a0&gt; &gt;&gt; &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>and</code></td>
<td><code>&lt;a0&gt; &amp; &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>or</code></td>
<td><code>&lt;a0&gt; | &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>xor</code></td>
<td><code>&lt;a0&gt; ^ &lt;a1&gt;</code></td>
</tr>
</tbody>
</table><p><span>The </span><code>not</code><span> instruction is similar, but operates on only one operand:</span></p><pre><code class="text hljs">not &lt;a0&gt; &lt;a1&gt;
</code></pre><p><span>It performs the bit-wise negation of the value of the register or literal </span><code>&lt;a0&gt;</code><span> and stores the result in the register addressed by </span><code>&lt;a1&gt;</code><span>.</span></p><h4 id="Comparison-instructions" data-id="Comparison-instructions"><a class="anchor hidden-xs" href="#Comparison-instructions" title="Comparison-instructions"><span class="octicon octicon-link"></span></a><span>Comparison instructions</span></h4><p><span>All comparison instructions are of the form:</span></p><pre><code class="text hljs">&lt;instr&gt; &lt;a0&gt; &lt;a1&gt; &lt;a2&gt;
</code></pre><p><span>Each comparison instruction treats </span><code>&lt;a0&gt;</code><span> and </span><code>&lt;a1&gt;</code><span> as either register addresses or literal values. It loads the register or literal values, computes the instruction's comparison operation, and stores the result in the register addressed by </span><code>&lt;a2&gt;</code><span>. If the comparison is true, the value stored in </span><code>&lt;a2&gt;</code><span> is 1, and otherwise it is 0.</span></p><table>
<thead>
<tr>
<th><span>Instruction</span></th>
<th><span>Operation (using Go syntax)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gt</code></td>
<td><code>&lt;a0&gt; &gt; &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>lt</code></td>
<td><code>&lt;a0&gt; &lt; &lt;a1&gt;</code></td>
</tr>
<tr>
<td><code>eq</code></td>
<td><code>&lt;a0&gt; == &lt;a1&gt;</code></td>
</tr>
</tbody>
</table><h4 id="Other-instructions" data-id="Other-instructions"><a class="anchor hidden-xs" href="#Other-instructions" title="Other-instructions"><span class="octicon octicon-link"></span></a><span>Other instructions</span></h4><h5 id="Move" data-id="Move"><a class="anchor hidden-xs" href="#Move" title="Move"><span class="octicon octicon-link"></span></a><span>Move</span></h5><pre><code class="text hljs">move &lt;a0&gt; &lt;a1&gt;
</code></pre><p><span>Copies the register or literal </span><code>&lt;a0&gt;</code><span> into the register </span><code>&lt;a1&gt;</code><span>.</span></p><h5 id="Conditional-move" data-id="Conditional-move"><a class="anchor hidden-xs" href="#Conditional-move" title="Conditional-move"><span class="octicon octicon-link"></span></a><span>Conditional move</span></h5><pre><code class="text hljs">cmove &lt;a0&gt; &lt;a1&gt; &lt;a2&gt;
</code></pre><p><span>If the register or literal </span><code>&lt;a0&gt;</code><span> is non-zero, copies the register or literal </span><code>&lt;a1&gt;</code><span> into the register </span><code>&lt;a2&gt;</code><span>. Otherwise, does nothing.</span></p><p><span>This is the core instruction for branching. Executing </span><code>cmove &lt;a0&gt; &lt;a1&gt; r7</code><span> will have the effect of conditionally overwriting </span><code>r7</code><span>, which is the instruction pointer, depending on the value of </span><code>&lt;a0&gt;</code><span>. See the provided </span><code>prime.asm</code><span> for an example of how to use this construct to implement a loop.</span></p><h5 id="Load" data-id="Load"><a class="anchor hidden-xs" href="#Load" title="Load"><span class="octicon octicon-link"></span></a><span>Load</span></h5><pre><code class="text hljs">load &lt;a0&gt; &lt;a1&gt;
</code></pre><p><span>Treats the register or literal </span><code>&lt;a0&gt;</code><span> as a memory address. Loads the word at this address and stores it in the register </span><code>&lt;a1&gt;</code><span>.</span></p><h5 id="Store" data-id="Store"><a class="anchor hidden-xs" href="#Store" title="Store"><span class="octicon octicon-link"></span></a><span>Store</span></h5><pre><code class="text hljs">load &lt;a0&gt; &lt;a1&gt;
</code></pre><p><span>Treats the register or literal </span><code>&lt;a1&gt;</code><span> as a memory address. Stores the register or literal </span><code>&lt;a0&gt;</code><span> at this address.</span></p><h5 id="Load-literal" data-id="Load-literal"><a class="anchor hidden-xs" href="#Load-literal" title="Load-literal"><span class="octicon octicon-link"></span></a><span>Load literal</span></h5><pre><code class="text hljs">loadLiteral &lt;a0&gt; &lt;a1&gt;
</code></pre><p><code>loadLiteral</code><span> is the one instruction which deviates from the normal instruction encoding scheme. A </span><code>loadLiteral</code><span> instruction is encoded as follows:</span></p><pre><code class="text hljs">MSB                          LSB
v                              v
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
|------||--------------||------|
  code         a0          a1
</code></pre><p><code>loadLiteral</code><span> stores the 16-bit value </span><code>a0</code><span> in the least-significant 16 bits of the register </span><code>a1</code><span>.</span></p><h5 id="Read" data-id="Read"><a class="anchor hidden-xs" href="#Read" title="Read"><span class="octicon octicon-link"></span></a><span>Read</span></h5><pre><code class="text hljs">read &lt;a0&gt;
</code></pre><p><span>Reads a byte from the input device and stores it in the least-significant bits of the register </span><code>&lt;a0&gt;</code><span>.</span></p><p><span>When executing a </span><code>read</code><span> instruction, the CPU will block until an input byte is available. If reading from the input device fails, the CPU will halt with an error.</span></p><h5 id="Write" data-id="Write"><a class="anchor hidden-xs" href="#Write" title="Write"><span class="octicon octicon-link"></span></a><span>Write</span></h5><pre><code class="text hljs">write &lt;a0&gt;
</code></pre><p><span>Writes the least-significant 8 bits of the register or literal </span><code>&lt;a0&gt;</code><span> to the output device.</span></p><p><span>When executing a </span><code>write</code><span> instruction, the CPU will block until the output byte is written. If writing to the output device fails, the CPU will halt with an error.</span></p><h5 id="Halt" data-id="Halt"><a class="anchor hidden-xs" href="#Halt" title="Halt"><span class="octicon octicon-link"></span></a><span>Halt</span></h5><pre><code class="text hljs">halt
</code></pre><p><span>Halts the execution of the CPU.</span></p><h5 id="Debug" data-id="Debug"><a class="anchor hidden-xs" href="#Debug" title="Debug"><span class="octicon octicon-link"></span></a><span>Debug</span></h5><pre><code class="text hljs">debug &lt;a0&gt;
</code></pre><p><span>Causes the emulator to print the CPU's current state to stderr. If the register or literal </span><code>&lt;a0&gt;</code><span> is non-zero, then the contents of memory are also printed.</span></p><h5 id="Unreachable" data-id="Unreachable"><a class="anchor hidden-xs" href="#Unreachable" title="Unreachable"><span class="octicon octicon-link"></span></a><span>Unreachable</span></h5><pre><code class="text hljs">unreachable
</code></pre><p><span>An instruction that should never be executed, similar to an assertion in a programming language. If </span><code>unreachable</code><span> is executed, the CPU immediately halts with an error.</span></p><h5 id="No-op" data-id="No-op"><a class="anchor hidden-xs" href="#No-op" title="No-op"><span class="octicon octicon-link"></span></a><span>No-op</span></h5><pre><code class="text hljs">nop
</code></pre><p><span>Do nothing. Note that </span><code>nop</code><span> is specifically chosen to have the instruction code 0, which means that any memory regions which are initialized to zero are implicitly filled with </span><code>nop</code><span> instructions. This is useful for debugging since it means that, if memory locations are executed erroneously, they are less likely to clobber state that may be important for debugging.</span></p><h2 id="Assembler" data-id="Assembler" style=""><a class="anchor hidden-xs" href="#Assembler" title="Assembler"><span class="octicon octicon-link"></span></a><span>Assembler</span></h2><p><span>We've provided a basic assembler which you can use to write your programs in a human-readable format rather than having to write instructions directly in their binary encoding.</span></p><p><span>We'll use this simple program to illustrate the assembler's features:</span></p><pre><code class="text hljs">    ; This program prints the numbers 0 through 9.
    
    loadLiteral 0 r0 ; Use r0 as the loop counter
    
loop:
    add r0 '0' r1 ; Store the ASCII encoding of r0 in r1
    write r1      ; Write the ASCII encoding to the output device
    
    lt r0 9 r1  ; Store 'r0 &lt; 10' in r1. Since we've already
                ; written to the output device, we don't need
                ; the contents of r1 anymore, and so we can
                ; re-use it to store the result of this comparison.
    add r0 1 r0 ; Increment the loop counter

    cmove r1 .loop r7 ; If 'r0 &lt; 9' (before incrementing), then we
                      ; need to loop at least one more time. We
                      ; implement this by moving the address of the
                      ; first instruction in the loop to r7, which
                      ; is the instruction pointer.
</code></pre><h3 id="Comments" data-id="Comments" style=""><a class="anchor hidden-xs" href="#Comments" title="Comments"><span class="octicon octicon-link"></span></a><span>Comments</span></h3><p><span>Comments are delimited using the </span><code>;</code><span> character.</span></p><h3 id="Literals" data-id="Literals" style=""><a class="anchor hidden-xs" href="#Literals" title="Literals"><span class="octicon octicon-link"></span></a><span>Literals</span></h3><p><span>Consider this instruction:</span></p><pre><code class="text hljs">lt r0 9 r1
</code></pre><p><span>In this instruction, </span><code>r0</code><span> and </span><code>r1</code><span> are registers, while </span><code>9</code><span> is the literal value 9. Literals are parsed using Go's </span><a href="https://pkg.go.dev/strconv#ParseUint" target="_blank" rel="noopener"><code>strconv.ParseUint</code></a><span>, and may be written in any format supported by that function (binary, octal, hex, etc).</span></p><p><span>In most instructions, literals can have values in the range [0, 127] (</span><span class="mathjax raw"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 119%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c37"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>127</mn><mo>=</mo><msup><mn>2</mn><mn>7</mn></msup><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span>). The one exception is </span><code>loadLiteral</code><span>: its literal argument can have values in the range [0, 65535] (</span><span class="mathjax raw"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="1" style="font-size: 119%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c36"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>65535</mn><mo>=</mo><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>16</mn></mrow></msup><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span>).</span></p><h4 id="ASCII" data-id="ASCII"><a class="anchor hidden-xs" href="#ASCII" title="ASCII"><span class="octicon octicon-link"></span></a><span>ASCII</span></h4><p><span>As a special-case, the assembler supports ASCII literals. Consider this instruction:</span></p><pre><code class="text hljs">add r0 '0' r1
</code></pre><p><span>In this instruction, </span><code>r0</code><span> and </span><code>r1</code><span> are registers, while </span><code>'0'</code><span> is a literal with the value 48 (the ASCII code for the character </span><code>0</code><span>). This is equivalent writing </span><code>48</code><span>.</span></p><h3 id="Labels" data-id="Labels" style=""><a class="anchor hidden-xs" href="#Labels" title="Labels"><span class="octicon octicon-link"></span></a><span>Labels</span></h3><p><span>It's often important to know the address of a particular instruction. Labels such as </span><code>loop:</code><span> can be used. The assembler will automatically compute the offset of the instruction following the label. Elsewhere in the program, the label can be used as a literal argument to other instructions (e.g., </span><code>.loop</code><span>).</span></p><p><span>Note that the assembler is only able to compute the label's offset </span><em><span>relative to the program it's assembling.</span></em><span> If the program is loaded at a location in memory other than address 0, then the label values cannot be jumped to directly, but must instead be offset by the appropriate amount. For example, consider this snippet from </span><code>prime.asm</code><span>, which uses this technique:</span></p><pre><code class="text hljs">; Store 1024 + .after_loop in r2
loadLiteral 1024 r2
add r2 .after_loop r2

; If r4 != 0, break out of the loop
cmove r4 r2 r7
</code></pre><p><em><span>Note that this has been lightly edited from how it is written in </span><code>prime.asm</code><span>.</span></em></p><p><span>As explained below, </span><code>prime.asm</code><span> expects to be loaded at offset 1024, and so it must add 1024 to all labels before jumping.</span></p><p><em><span>Style note: The recommended style is to indent all instructions and comments, and to leave labels as the only un-indented items. This aids in readability. That said, the assembler is agnostic to indentation; using other indentation will not affect the behavior of your programs.</span></em></p><h2 id="Debugger" data-id="Debugger" style=""><a class="anchor hidden-xs" href="#Debugger" title="Debugger"><span class="octicon octicon-link"></span></a><span>Debugger</span></h2><p><span>We've provided a basic debugger which supports step-by-step execution and breakpoints. To run the CPU emulator in the debugger, use the </span><code>--debug</code><span> flag (e.g., </span><code>go run *.go --debug bootloader.asm prime_embedded.asm</code><span>).</span></p><p><span>To see more about the functionality offered by the debugger, launch the debugger and then run the </span><code>help</code><span> command.</span></p><h2 id="Assignment-1-Bootloader" data-id="Assignment-1-Bootloader" style=""><a class="anchor hidden-xs" href="#Assignment-1-Bootloader" title="Assignment-1-Bootloader"><span class="octicon octicon-link"></span></a><span>Assignment 1: Bootloader</span></h2><p><em><span>Due date: Wednesday, April 17th at 11:59pm</span></em></p><p><span>Your first assignment is to implement a very simple bootloader. This will help you gain familiarity with programming in this assembly language, and it will form the basis of the kernel that you will hand in for Assignment 2.</span></p><p><span>We have provided a number of </span><code>.go</code><span> files that implement the CPU emulator. You can run them like so:</span></p><pre><code class="text hljs">go run *.go bootloader.asm prime_embedded.asm
</code></pre><p><span>The emulator takes two arguments: a bootloader and a program.</span></p><p><span>First, the emulator allocates 2,048 words of memory and initializes them to zero. It assembles the bootloader, and copies the resulting instruction sequence into memory starting at word 0. The bootloader's instruction sequence may be at most 1,024 words long.</span></p><p><span>Next, the emulator assembles the program, whose instruction sequence may also be at most 1,024 words long. The emulator fills the input device's buffer with two objects:</span></p><ul>
<li><span>First, it calculates the program's length (in words) as an unsigned 16-bit integer. It stores this integer in </span><a href="https://www.freecodecamp.org/news/what-is-endianness-big-endian-vs-little-endian/" target="_blank" rel="noopener"><span>big-endian byte order</span></a><span> as the first two bytes of the input buffer.</span></li>
<li><span>Second, it converts each of the program's words to a 4-byte value (also in big-endian byte order). It adds these bytes to the input buffer.</span></li>
</ul><p><span>Finally, the emulator begins executing, initializing all registers (including the instruction pointer, </span><code>r7</code><span>) to 0.</span></p><p><span>Your bootloader's job is to:</span></p><ul>
<li><span>Read the program from the input device and store it in memory starting at address 1,024</span></li>
<li><span>Execute the program by jumping to address 1,024</span></li>
</ul><p><span>We provide an example program, </span><code>prime_embedded.asm</code><span>, that you can use to test your bootloader.</span></p><p><em><span>Assignment 1 should not require modifying the emulator (i.e., the </span><code>.go</code><span> files) in any way. Our auto-grader will ignore any </span><code>.go</code><span> files that you submit.</span></em></p><h3 id="Interacting-with-the-Autograder" data-id="Interacting-with-the-Autograder" style=""><a class="anchor hidden-xs" href="#Interacting-with-the-Autograder" title="Interacting-with-the-Autograder"><span class="octicon octicon-link"></span></a><span>Interacting with the Autograder</span></h3><p><span>To interact with the autograder for this assignment, submit your implementation of </span><code>bootloader.asm</code><span> to Gradescope. The autograder for this assignment will use your bootloader to run a set of testing programs (including </span><code>prime_embedded.asm</code><span>) and check that their output is as expected.</span></p><h2 id="Assignment-2-Kernel" data-id="Assignment-2-Kernel" style=""><a class="anchor hidden-xs" href="#Assignment-2-Kernel" title="Assignment-2-Kernel"><span class="octicon octicon-link"></span></a><span>Assignment 2: Kernel</span></h2><p><em><span>Due date: Wednesday, May 1st at 11:59pm</span></em></p><p><em><span>More details coming soon</span><span class="smartypants">…</span></em></p><h2 id="Assignment-3-Hacking" data-id="Assignment-3-Hacking" style=""><a class="anchor hidden-xs" href="#Assignment-3-Hacking" title="Assignment-3-Hacking"><span class="octicon octicon-link"></span></a><span>Assignment 3: Hacking</span></h2><p><em><span>Due date: TBD</span></em></p><p><em><span>More details coming soon</span><span class="smartypants">…</span></em></p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Project-4-Kernel" title="Project 4: Kernel">Project 4: Kernel</a><ul class="nav">
<li class=""><a href="#Architecture" title="Architecture">Architecture</a><ul class="nav">
<li class=""><a href="#Words" title="Words">Words</a></li>
<li><a href="#Memory" title="Memory">Memory</a></li>
<li class=""><a href="#Registers" title="Registers">Registers</a></li>
<li class=""><a href="#IO" title="I/O">I/O</a></li>
<li><a href="#Halting" title="Halting">Halting</a></li>
<li class=""><a href="#Execution" title="Execution">Execution</a></li>
<li class=""><a href="#Instruction-encoding" title="Instruction encoding">Instruction encoding</a></li>
<li class=""><a href="#Instruction-reference" title="Instruction reference">Instruction reference</a></li>
</ul>
</li>
<li><a href="#Assembler" title="Assembler">Assembler</a><ul class="nav">
<li><a href="#Comments" title="Comments">Comments</a></li>
<li><a href="#Literals" title="Literals">Literals</a></li>
<li><a href="#Labels" title="Labels">Labels</a></li>
</ul>
</li>
<li><a href="#Debugger" title="Debugger">Debugger</a></li>
<li><a href="#Assignment-1-Bootloader" title="Assignment 1: Bootloader">Assignment 1: Bootloader</a><ul class="nav">
<li><a href="#Interacting-with-the-Autograder" title="Interacting with the Autograder">Interacting with the Autograder</a></li>
</ul>
</li>
<li><a href="#Assignment-2-Kernel" title="Assignment 2: Kernel">Assignment 2: Kernel</a></li>
<li class=""><a href="#Assignment-3-Hacking" title="Assignment 3: Hacking">Assignment 3: Hacking</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Project-4-Kernel" title="Project 4: Kernel">Project 4: Kernel</a><ul class="nav">
<li class=""><a href="#Architecture" title="Architecture">Architecture</a><ul class="nav">
<li class=""><a href="#Words" title="Words">Words</a></li>
<li><a href="#Memory" title="Memory">Memory</a></li>
<li class=""><a href="#Registers" title="Registers">Registers</a></li>
<li class=""><a href="#IO" title="I/O">I/O</a></li>
<li><a href="#Halting" title="Halting">Halting</a></li>
<li class=""><a href="#Execution" title="Execution">Execution</a></li>
<li class=""><a href="#Instruction-encoding" title="Instruction encoding">Instruction encoding</a></li>
<li class=""><a href="#Instruction-reference" title="Instruction reference">Instruction reference</a></li>
</ul>
</li>
<li><a href="#Assembler" title="Assembler">Assembler</a><ul class="nav">
<li><a href="#Comments" title="Comments">Comments</a></li>
<li><a href="#Literals" title="Literals">Literals</a></li>
<li><a href="#Labels" title="Labels">Labels</a></li>
</ul>
</li>
<li><a href="#Debugger" title="Debugger">Debugger</a></li>
<li><a href="#Assignment-1-Bootloader" title="Assignment 1: Bootloader">Assignment 1: Bootloader</a><ul class="nav">
<li><a href="#Interacting-with-the-Autograder" title="Interacting with the Autograder">Interacting with the Autograder</a></li>
</ul>
</li>
<li><a href="#Assignment-2-Kernel" title="Assignment 2: Kernel">Assignment 2: Kernel</a></li>
<li class=""><a href="#Assignment-3-Hacking" title="Assignment 3: Hacking">Assignment 3: Hacking</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
